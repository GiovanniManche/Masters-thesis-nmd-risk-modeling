# Master's thesis: Non-maturity deposits margin risk, a multi-channel study
![Python](https://img.shields.io/badge/Python-3.10-blue)
![R](https://img.shields.io/badge/R-4.3.2-blue)

## Introduction

This repository contains the code developed for my master’s thesis in the MSc in Economic and Financial Engineering – Quantitative Finance track at Université Paris-Dauphine (PSL). The thesis investigates **how the choice of the NMD runoff model and the interest-rate regime jointly impact the short run net interest margin of non-maturity deposits (NMDs).**

**Author:** Giovanni MANCHE \
**Date:** June 2025

## Contents

- [Description](#description)
- [Measuring the pass-through rate and Forecasting the offered rate](#measuring-the-pass-through-rate-and-forecasting-the-offered-rate)
- [Modeling the non-maturity deposits runoff](#modeling-the-non-maturity-deposits-runoff)
- [Forecasting the yield curve: a Dynamic Nelson-Siegel approach](#forecasting-the-yield-curve-a-dynamic-nelson-siegel-approach)
- [Forecasting the rate margin and sensitivity measure](#forecasting-the-rate-margin-and-sensitivity-measure)
- [Project organisation](#project-organisation)

## Description 
Non-maturity deposits represent a major source of risk for banks, as they entail both **liquidity risk** and  **interest rate risk** (and those two dimensions are themselves interlinked). Because NMDs have **no contractual maturity**, clients can *technically* withdraw their funds overnight. However, in return, these deposits often are the **cheapest source of funding** for a bank, as they are either non-remunerated or remunerated at rates well below market levels. 

The interest rate margin generated by NMDs can thus be measured as the difference between **what the bank pays its clients for liquidity** (if anything) and **the returns it earns from using this liquidity**. It is a core problem of Asset-Liability Management. 

Although highly valuable for banks, NMDs are inherently risky. Their behaviour must be modelled, as it is empirically observed that clients do not, in fact, withdraw their deposits overnight but rather progressively. Once the deposit outflows model is estimated, one must formulate interest rate scenarios to measure how the margin would evolve depending on the market regime. The goal of this thesis is to explore different ways of doing so, and conclude whether the **rate environment and the chosen runoff model should be considered jointly** in a coherent risk-management framework. Our results show that the interaction between model choice and rate regime is **statistically significant**, highlighting a *tangible* interaction risk that banks should account for.

Usual statistical tests (such as unit root tests and non-autocorrelation test) were performed throughout the whole thesis at several steps, with eventual treatment if needed. 

## Measuring the pass-through rate and Forecasting the offered rate 

The pass-through rate **measures the sensitivity of the offered rate to changes in a market reference rate** (e.g. EURIBOR 3M). It needs modeling because it directly impacts the deposit outflows. To do so, we tested several specifications, finally settling on an **error-correction model** between the offered rate and the EURIBOR 12M:

```math
\Delta r_{\text{offered}, t} = \alpha + \beta \Delta EUR_{12M,t} + \gamma (r_{\text{offered}, t-1} - a - b EUR_{12M, t-1}) + u_t
```
with:
- $\beta$: short-run pass-through rate  
- $b$: long-run pass-through rate  
- $\gamma$: adjustment rate / mean-reversion speed  

To have a single value, our proposal is to combine both short-run and long-run pass-through rate, weighted by the adjustment coefficient. 

This ECM will later be used to forecast the offered rate, based on forecasted values of the EURIBOR 12M.

## Modeling the non-maturity deposits runoff
To estimate the runoff model, we used a time-series analysis based on three steps.

### Step 1: concentrated part 
If a non-negligible share of total deposits are detained by a small group of clients, it is necessary to account for the potential **concentration effect** they may create: a small group could decide to withdraw their deposits, and since they represent a large portion of total outstandings, such withdrawals would have a severe impact on the bank. 

To measure concentration, one could use granular data and plot a Lorenz curve and/or compute a Gini coefficient. The percentage of the total deposit amount held by 1% of the clients should be assigned to a very short runoff horizon. 

### Step 2: stable and variable part
The stable part represents the fraction of total outstandings that is empirically stable over time and should therefore have a longer maturity. To model it, one should: 
1. Decompose the time series between trend, seasonality and noise. 
2. Remove the seasonal component. 
3. Study the noise (stationarity, normality), 
4. Use a formula depending on the 99%-centile of the noise (and thus its law if known) to compute the proportion of total outstandings stable.

A percentage of the stable part needs to be **variable** because of the pass-through rate. The percentage of the stable part sensitive to interest rate (and thus with a shorter maturity) is equal to the pass-through rate.

Finally, the share of total oustandings left (neither stable, variable nor concentrated) is called fluctuating and correspond to seasonality effects.

### Step 3: determine the maturity of the parts
- Maturity of the concentrated part is fixed heuristically
- Maturity of the fluctuating part depends on the length of the seasonality cycle (if annual seasonality, the maturity would be 12 months)
- Maturity of the variable part should correspond to the market rate used (12 months for the EUROIBOR 12M for instance)
- Maturity of the stable part is computed based on a principle that hedges cannot be reversed once established and a functional linear form of the runoff function. 

*Further methodological details and calibration formulas are not disclosed here for confidentiality reasons.*

## Forecasting the yield curve: a Dynamic Nelson-Siegel approach
### Classic fixed coefficient approaches
To forecast the yield curve, we decided to use the Nelson-Siegel factor model. Following Diebold & Li (2006), we forecast the terms structure by **forecasting the Nelson-Siegel factors**. Formally, we estimate:
```math
r_t(\tau) = \underbrace{\beta_{1t}}_{\text{level}} + \underbrace{\beta_{2t}}_{\text{slope}} \left(\frac{1 - e^{-\lambda_t \tau}}{\lambda_t \tau} \right) + \underbrace{\beta_{3t}}_{\text{curvature}} \left(\frac{1 - e^{-\lambda_t \tau}}{\lambda_t \tau} - e^{-\lambda_t \tau} \right), 
```
then use **AR(1) models and a VAR(1)** on the factors to forecast them. However, we find that the stationarity of the factors is not clear, and performing the **Johansen cointegration test** reveals the presence of one cointegration relationship. Thus, we estimate a VECM model and see that, on average, its forecast RMSE is lower. 

### Time-Varying Parameters VAR
To account for the potential **structural breaks** in factors' relationships (for instance, after 2022 and the new restrictive monetary policy regime in the Euro Area), we adopt a TVP-VAR model, following the **Koop & Korobilis (2013) method**. To summarise, the TVP-VAR can be written as a state-space model:
```math
B_{t} = M_t B_{t-1} + C_t + v_t, v_t \sim N(0, Q_t) \ \text{(Transition equation)} 
```
```math
  \beta_t = B_{\textbf{t}} \beta_{t-1}  + D_t + w_t, w_t \sim N(0, H_t) \ \text{(Measurement equation)} 
```
with $B_t$ the **unobserved coefficients** of the TVP-VAR and $\beta_t$ the "observed" Nelson-Siegel factors.

Predictions are obtained using the Kalman filter. We implement the Koop and Korobilis method of recursive updating of the coefficient variance matrix using a **forgetting factor** $\lambda \in ]0,1]$. After some calculations, they write that: 
```math
Q_t = \left(\frac{1}{\lambda} - 1\right) Var(B_t | \beta_{1:t-1}),
```
thus allowing for an interpretation of the forgetting factor coefficient: the closer it is to one, the slower coefficients adjust; the smaller $\lambda$ is, the faster coefficients adapt to new information. 

This method allows for better prediction, as one could run several Kalman filters in parallel with different $\lambda$ values, and combine the predictions by weighted averaging. In fact, the **Dynamic Model Averaging approach** we used to weight each prediction by the probability that the model with a particular $\lambda$ is the "good" model. Without going into details, this probability is recursively updated from likelihood ratios.

Doing this, we see that the weights given to faster adjustment models increase dramatically during rupture periods, like in 2012 or, more so, in 2022. Using this TVP-VAR DMA approach, we finally obtain forecasts for the yield curve. 

Those projections can be found in the ``images/Chapitre 3`` folder. 

## Forecasting the rate margin and sensitivity measure
To compute the rate of a given part of the outstandings (stable, fluctuating,...), we need to make the strong assumption that **outstandings are constant**. As the part is dynamically renewed, the remuneration rate (corresponding to the market rate for its maturity, as the bank can place the liquidity on the market) corresponds to a weighted mean of the former remuneration rate (portion already placed and not renewed) and the new market rate (portion renewed of the total part). 

To compute the offered client rate, we use the ECM from earlier. The interest rate margin is given by the difference between the total remuneration rate and the client rate. 

We then forecast yield curves for different market stress scenarios: upward/downward shocks on short-term/long-term interest rates and parallel shocks. We also modify the runoff model estimated parameters to have shorter or longer models, sensitive or less sensitive ones. Obviously, we also keep a "baseline" scenario without any shocks and the real model estimated previously. 

We then compute the interest rate margin for each of the five models in each of the six market scenarios, and run an ANOVA test on the model: 
```math
Margin_{ij} = c + \underbrace{\alpha_i}_{\text{Model effect}} + \underbrace{\gamma_j}_{\text{Market rate effect}}  + \underbrace{{\alpha\gamma}_{ij}}_{\text{Interaction effect}} + \varepsilon_{ijk}
```
The results show that if the market rate effect is prevalent, the interaction effect is still statistically significant. 

## Project organisation 
- ``dynamic-nelson-siegel`` folder contains the data used to estimate the Nelson-Siegel factors (market rates and swap rates, extracted from *Bloomberg*), functions to perform statistical tests, perform the various estimations and predictions (notably, Kalman filter with forgetting factor) and a main script that can be run to get rate scenarios for various shocks. This section was coded in R, as its statistical tools proved to be more useful.
- ``impacts_marge`` folder contains the code used to compute the remuneration rates for the bank (constant outstandings) and the future client rate, using forecasts from R converted to Excel. This was coded in Python.
- ``écoulement`` folder contains different functions used to model the non-maturity deposit runoff (regressions mostly) that are then used in the main Notebook. There are also two Excel files used to show *manually* how the dynamic runoff and renewal actually work. *Granular data used for the model estimation is confidential and cannot be made available.*
- ``Main.ipynb`` file is the notebook that contains all the details and progressive explanations and results. 
- A Beamer presentation (in French) is also available.

---
## References
- **Byrne, J. P., Cao, S., & Korobilis, D.** (2017). *Forecasting the term structure of government bond yields in unstable environments*.
*Journal of Empirical Finance*, 44, 209–225.

- **Nelson, C. R., & Siegel, A. F.** (1987). *Parsimonious modeling of yield curve*.
*Journal of Business*, 60, 473–489.

- **Diebold, F. X., & Li, C.** (2006). *Forecasting the term structure of government bond yields*.
*Journal of Econometrics*, 130, 337–364.

- **Koop, G., & Korobilis, D. (2013)**. *Large time-varying parameter VARs*.
*Journal of Econometrics*, 177, 185–198.

- **Koop, G., & Korobilis, D. (2012)**. *Forecasting inflation using dynamic model averaging*.
*International Economic Review*, 53 (August).

- **Parzen, E. (1962)**. *On Estimation of a Probability Density Function and Mode*.
*The Annals of Mathematical Statistics*, 33(3), 1065–1076.

- **Lorenz, M. O. (1905)**. *Methods of measuring the concentration of wealth*.
*American Statistical Association*, 9, 209–219.

- **Banque de France. (2025)**. Agrégats monétaires France, M2, Comptes sur livrets [taux de croissance trimestriel annualisé] (CVS-CJO).
https://webstat.banque-france.fr/fr/catalogue/bsi1/BSI1.M.FR.Y.V.L23.D.I.U6.2300.Z01.3
 — consulté le 31 mai 2025.

- **European Banking Authority**. (2022). *Final Report – Guidelines on the Management of Interest Rate Risk and Credit Spread Risk arising from Non-Trading Book Activities (EBA/GL/2022/14)*.
https://www.eba.europa.eu/regulation-and-policy/internal-governance/guidelines-management-interest-rate-risk-and-credit-spread-risk
 — applicable from 30 June 2023.

- **Ielpo, F., Merhy, C., & Simon, G**. (2017). *Engineering Investment Process: Making Value Creation Repeatable*.
*ISTE Press Ltd & Elsevier Ltd*.

**Coface. (2023, March 13)**. *La faillite de Silicon Valley Bank met en évidence des risques accrus pour la stabilité financière dans un contexte de resserrement monétaire.*

**Le Monde. (2023, March 11)**. *La fermeture de la Silicon Valley Bank, plus grosse faillite bancaire depuis la crise de 2008.*

**Tampereau, Y. (Caisse des Dépôts et Consignations)**. (2023, February 21). *Épargne des ménages : après la sur-épargne covid, quelle normalisation ? Quelles perspectives ?*
https://www.caissedesdepots.fr/blog/article/apres-la-sur-epargne-covid-normalisation-et-perspectives
